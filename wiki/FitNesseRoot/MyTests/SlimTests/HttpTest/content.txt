!define URL {http://wsf.cdyne.com/WeatherWS/Weather.asmx}

!2 Body in Wiki

Send a HTTP POST supplying the content to post in a variable so the script table does not have newlines in its cells. 

!define POST_BODY { {{{
<s11:Envelope xmlns:s11="http://schemas.xmlsoap.org/soap/envelope/">
  <s11:Body>
    <ns1:GetCityWeatherByZIP xmlns:ns1="http://ws.cdyne.com/WeatherWS/">
      <ns1:ZIP>90210</ns1:ZIP>
    </ns1:GetCityWeatherByZIP>
  </s11:Body>
</s11:Envelope>
}}} }

|script         |xml http test                                                       |
|post           |${POST_BODY}   |to                   |${URL}                        |
|check          |response status|200                                                 |
|show           |response                                                            |
|register prefix|weather        |for namespace        |http://ws.cdyne.com/WeatherWS/|
|check          |xPath          |//weather:City/text()|Beverly Hills                 |


!2 Body via scenario

Using a scenario allows us to generate multiple request, only changing certain values.

!*> Scenario definition
!define POST_BODY_2 { {{{
<s11:Envelope xmlns:s11="http://schemas.xmlsoap.org/soap/envelope/">
  <s11:Body>
    <ns1:GetCityWeatherByZIP xmlns:ns1="http://ws.cdyne.com/WeatherWS/">
      <ns1:ZIP>@{zip}</ns1:ZIP>
    </ns1:GetCityWeatherByZIP>
  </s11:Body>
</s11:Envelope>
}}} }

|script|xml http test|

|auto-scenario  |send request                                                        |
|post           |${POST_BODY_2} |to                   |${URL}                        |
|check          |response status|200                                                 |
|show           |response                                                            |
|register prefix|weather        |for namespace        |http://ws.cdyne.com/WeatherWS/|
|check          |xPath          |//weather:City/text()|@{City}                       |
*!

|send request       |
|zip  |City         |
|10007|New York     |
|94102|San Francisco|

!2 Http GET

Performs HTTP GET instead of POST

|script         |xml http test                                                       |
|set value      |90210          |for                  |ZIP                           |
|get from       |${URL}/GetCityWeatherByZIP                                          |
|check          |response status|200                                                 |
|show           |request                                                             |
|show           |response                                                            |
|register prefix|weather        |for namespace        |http://ws.cdyne.com/WeatherWS/|
|check          |xPath          |//weather:City/text()|Beverly Hills                 |



!2 Body from template

By using a Freemarker template we can have more dynamic body content.

|script          |xml http test                                                                                       |
|template        |samplePost.ftl.xml                                                                                  |
|set value       |http://www.webserviceX.NET/GetWeather  |for header                       |SOAPAction                |
|set value       |Canada                                 |for                              |countryName               |
|post template to|http://www.webservicex.com/globalweather.asmx                                                       |
|check           |response status                        |500                                                         |
|show            |request                                                                                             |
|show            |response                                                                                            |
|register prefix |wsX                                    |for namespace                    |http://www.webserviceX.NET|
|set value       |Vancouver International Air-Port, B. C.|for                              |cityName                  |
|post template to|http://www.webservicex.com/globalweather.asmx                                                       |
|check           |response status                        |200                                                         |
|show            |request                                                                                             |
|show            |response                                                                                            |
|check           |xPath                                  |!-//wsX:GetWeatherResult/text()-!|                          |
